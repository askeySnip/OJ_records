<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
Aliens on the planet Htrae have <b>G</b> different bases in their DNA.
In this problem, we will number the bases 0 through <b>G</b>-1.
</p>
<p>
You are given the DNA of an alien specimen: the vector &lt;int&gt; A with <b>N</b> elements.
</p>
<p>
During an alien's life their DNA changes: some bases disappear (without changing order of the remaining ones).
Hence, the future DNA is always a subsequence of the current DNA.
For example, if the current DNA is {10, 20, 30, 40, 50}, one possible future DNA is {10, 40} and another one is {}.
</p>
<p>
Clearly, the set of possible future DNAs for our specimen is finite.
Let I be its infinite complement: the set of DNAs such that our specimen cannot have them.
</p>
<p>
We are interested in two values:
</p>
<ul>
<li>L = the length of the shortest DNA in I</li>
<li>X = the number of DNAs of length L in I, modulo 10^9 + 7</li>
</ul>
<p>
Return { L, X }.
</p>
<p>
Use the following pseudocode to generate A:
</p>
<pre>
A = Aprefix
state = last element of Aprefix
while length(A) &lt; N:
    state = (state * 1103515245 + 12345) modulo 2^31
    A.append( state modulo G )
</pre></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>ShortestMissingSubsequences</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>int, int, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>vector &lt;int&gt;</td></tr><tr><td>Method signature:</td><td>vector &lt;int&gt; count(int G, int N, vector &lt;int&gt; Aprefix)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>As usual, the reference solution does not depend on the properties of the pseudorandom generator and it would work within the time limit for any other input of the same size.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>G</b> will be between 1 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>N</b> will be between 1 and 2,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>Aprefix</b> will have between 1 and 100 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>Aprefix</b> will be between 0 and <b>G</b>-1, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>4</pre></td></tr><tr><td><pre>{1, 0, 0, 1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {3, 5 }</pre></td></tr><tr><td><table><tr><td colspan="2">The shortest impossible DNAs are {0,0,0}, {0,1,0}, {0,1,1}, {1,1,0}, and {1,1,1}.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>4</pre></td></tr><tr><td><pre>{1, 0, 0, 1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {1, 3 }</pre></td></tr><tr><td><table><tr><td colspan="2">The shortest impossible DNAs are {2}, {3}, and {4}.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>7</pre></td></tr><tr><td><pre>7</pre></td></tr><tr><td><pre>{0, 1, 2, 3, 4, 5, 6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {2, 28 }</pre></td></tr><tr><td><table><tr><td colspan="2">The shortest impossible DNAs have the form {x, y} where x &gt;= y.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>7</pre></td></tr><tr><td><pre>14</pre></td></tr><tr><td><pre>{0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {2, 21 }</pre></td></tr><tr><td><table><tr><td colspan="2">The shortest impossible DNAs have the form {x, y} where x &gt; y.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>10</pre></td></tr><tr><td><pre>{1, 2, 0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: {3, 6 }</pre></td></tr><tr><td><table><tr><td colspan="2"><p>
The sequence A you should generate is {1, 2, 0, 0, 1, 2, 1, 2, 2, 2}.
</p>
<p>
The six DNAs of length 3 this alien cannot have are {0, 0, 0}, {0, 1, 0}, {0, 2, 0}, {1, 1, 0}, {2, 1, 0}, and {2, 2, 0}.
</p></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
